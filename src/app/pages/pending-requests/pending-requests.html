<mat-card>
  <mat-card-header>
    <mat-card-title>Richieste da approvare</mat-card-title>
    <mat-card-subtitle *ngIf="!isLoading && requests.length">
      In attesa di approvazione
    </mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div *ngIf="isLoading">Caricamento...</div>

    <div class="table-container" *ngIf="!isLoading && requests.length">
      <table
        mat-table
        [dataSource]="requests"
        class="styled-table mat-elevation-z2"
      >
        <!-- Oggetto -->
        <ng-container matColumnDef="object">
          <th mat-header-cell *matHeaderCellDef>Oggetto</th>
          <td mat-cell *matCellDef="let r">{{ r.object }}</td>
        </ng-container>

        <!-- Quantità -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>Quantità</th>
          <td mat-cell *matCellDef="let r">{{ r.quantity }}</td>
        </ng-container>

        <!-- Prezzo -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef>Prezzo</th>
          <td mat-cell *matCellDef="let r">€{{ r.price }}</td>
        </ng-container>

        <!-- Utente -->
        <ng-container matColumnDef="user">
          <th mat-header-cell *matHeaderCellDef>Richiedente</th>
          <td mat-cell *matCellDef="let r">
            <mat-icon color="accent">person</mat-icon>
            {{ getFullName(r.userId) }}
          </td>
        </ng-container>

        <!-- Azioni -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Azioni</th>
          <td mat-cell *matCellDef="let r" class="action-buttons">
            <button
              mat-mini-fab
              color="primary"
              (click)="approve(r.id)"
              matTooltip="Approva"
            >
              <mat-icon>check</mat-icon>
            </button>
            <button
              mat-mini-fab
              color="warn"
              (click)="reject(r.id)"
              matTooltip="Rifiuta"
            >
              <mat-icon>close</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="['object', 'quantity', 'price', 'user', 'actions']"
        ></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: ['object', 'quantity', 'price', 'user', 'actions']"
        ></tr>
      </table>
    </div>

    <div *ngIf="!isLoading && !requests.length" class="empty-message">
      Nessuna richiesta in attesa di approvazione.
    </div>
  </mat-card-content>
</mat-card>
